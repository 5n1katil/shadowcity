{
  "rules": {
    ".read": false,
    ".write": false,

    "rooms": {
      "$roomCode": {
        // Oda içindeki verileri okuyabilmek için:
        // kullanıcı o odada players altında kayıtlı olmalı (host da kayıtlı olacak)
        ".read": "auth != null && data.child('players').child(auth.uid).exists()",
        ".write": "auth != null && data.child('players').child(auth.uid).exists()",

        "settings": {
          // settings sadece host tarafından yazılır (oda kurulumu + ayarlar)
          ".write": "auth != null && data.parent().child('settings').child('creatorUid').val() === auth.uid"
        },

        "players": {
          "$uid": {
            // Her oyuncu kendi kaydını oluşturabilir/ güncelleyebilir
            ".write": "auth != null && $uid === auth.uid",
            ".read": "auth != null && data.parent().child(auth.uid).exists()"
          }
        },

        "secret": {
          "roles": {
            "$uid": {
              // Oyuncu sadece kendi rolünü okur
              ".read": "auth != null && $uid === auth.uid",
              // Rolleri sadece host yazar
              ".write": "auth != null && data.parent().parent().parent().child('settings').child('creatorUid').val() === auth.uid"
            }
          }
        },

        "state": {
          // faz/süre yönetimi host
          ".write": "auth != null && data.parent().child('settings').child('creatorUid').val() === auth.uid"
        },

        "day": {
          "voteCall": {
            "requests": {
              "$uid": {
                // oylama çağrısı: herkes kendi isteğini yazabilir
                ".write": "auth != null && $uid === auth.uid"
              }
            }
          }
        },

        "voting": {
          "votes": {
            "$uid": {
              // oy: herkes kendi oyunu yazar
              ".write": "auth != null && $uid === auth.uid"
            }
          },
          // sonucu host yazar
          "result": {
            ".write": "auth != null && data.parent().parent().child('settings').child('creatorUid').val() === auth.uid"
          }
        },

        "night": {
          "actions": {
            // gece aksiyonlarını herkes yazamasın:
            // burada basit tutuyoruz: host yazabilir + oyuncular kendi rol aksiyonunu yazacak (bir sonraki patchte daha da sıkılaştırırız)
            ".write": "auth != null && data.parent().parent().child('players').child(auth.uid).exists()"
          },
          "results": {
            // gece sonuçlarını host yazar, oyuncular okur
            ".write": "auth != null && data.parent().parent().child('settings').child('creatorUid').val() === auth.uid"
          }
        },

        "log": {
          // log sadece host yazar, herkes okur
          ".write": "auth != null && data.parent().child('settings').child('creatorUid').val() === auth.uid"
        }
      }
    }
  }
}
